/*
 * Icinga2 Twilio Notification Commands
 * 
 * CONFIGURATION:
 * Credentials are stored in /etc/icinga2/twilio-config.json
 * Scripts read from the JSON file using jq
 * 
 * Add this to your Icinga2 configuration (e.g., /etc/icinga2/conf.d/commands.conf)
 */

object NotificationCommand "twilio-host-notification" {
  command = [ "/usr/local/bin/twilio-host-notification.sh" ]

  arguments = {
    "$user.pager$" = {
      required = true
      description = "Phone number to send SMS to (in E.164 format, e.g., +15551234567)"
      order = 1
    }
    "$notification.type$" = {
      value = "$notification.type$"
      description = "Notification type (PROBLEM, RECOVERY, etc.)"
      order = 2
    }
    "$host.name$" = {
      value = "$host.name$"
      description = "Host name"
      order = 3
    }
    "$host.state$" = {
      value = "$host.state$"
      description = "Host state (UP, DOWN, UNREACHABLE)"
      order = 4
    }
    "$host.address$" = {
      value = "$host.address$"
      description = "Host IP address"
      order = 5
    }
    "$host.output$" = {
      value = "$host.output$"
      description = "Host check output"
      order = 6
    }
  }
}

object NotificationCommand "twilio-service-notification" {
  command = [ "/usr/local/bin/twilio-service-notification.sh" ]

  arguments = {
    "$user.pager$" = {
      required = true
      description = "Phone number to send SMS to (in E.164 format, e.g., +15551234567)"
      order = 1
    }
    "$notification.type$" = {
      value = "$notification.type$"
      description = "Notification type (PROBLEM, RECOVERY, etc.)"
      order = 2
    }
    "$service.name$" = {
      value = "$service.name$"
      description = "Service name"
      order = 3
    }
    "$host.name$" = {
      value = "$host.name$"
      description = "Host name"
      order = 4
    }
    "$service.state$" = {
      value = "$service.state$"
      description = "Service state (OK, WARNING, CRITICAL, UNKNOWN)"
      order = 5
    }
    "$service.output$" = {
      value = "$service.output$"
      description = "Service check output"
      order = 6
    }
  }
}
